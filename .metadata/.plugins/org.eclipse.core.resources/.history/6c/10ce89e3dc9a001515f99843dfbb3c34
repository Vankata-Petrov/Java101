package friday.todolist.implementation;

import java.util.Comparator;
import java.util.PriorityQueue;

import friday.todolist.task.Task;

public class ToDoList {
	private PriorityQueue<Task> tasks;
	private int remainingTime;

	public ToDoList(int remainingTime) {
		this.remainingTime = remainingTime;
		tasks = new PriorityQueue<>(new Comparator<Task>() {
			@Override
			public int compare(Task task1, Task task2) {
				return task1.getTimeNeeded() > task2.getTimeNeeded() ? -1
						: task1.getTimeNeeded() < task2.getTimeNeeded() ? 1 : 0;
			}
		});
	}

	public void addTask(Task task) {
		tasks.add(task);
	}

	public void markFinished(Task t) {
		tasks.remove(t);
		t.finish();
	}

	public void markCancelled(Task t) {
		tasks.remove(t);
		t.cancel();
	}

	public boolean canFinish() {
		return remainingTime > getTimeNeeded();
	}

	public Task top() {
		return tasks.peek();
	}

	public float getTimeNeeded() {
		float sum = 0;
		for (Task task : tasks) {
			sum += task.getTimeNeeded();
		}
		return sum;
	}

}
