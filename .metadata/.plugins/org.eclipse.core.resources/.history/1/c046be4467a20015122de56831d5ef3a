package friday.shopinventory.model;

import java.util.ArrayList;
import java.util.List;

import friday.shopinventory.database.ProductDataBase;
import friday.shopinventory.exceptions.ProductNotFoundException;

public class Order {
	public class ProductInfo<K, V> {
		private int id;
		private int quantity;

		public ProductInfo(int id, int quantity) {
			this.id = id;
			this.quantity = quantity;
		}

		public int getId() {
			return id;
		}

		public int getQuantity() {
			return quantity;
		}

		@Override
		public String toString() {
			return "ProductInfo [id=" + id + ", quantity=" + quantity + "]";
		}

	}

	private List<ProductInfo<Integer, Integer>> info;

	public Order(int... productId) throws ProductNotFoundException {
		try {
			info = new ArrayList<>(productId.length);
			for (int id : productId) {
				Product product = ProductDataBase.getProducts().get(id);
				int quantity = product.getQuantity();
				info.add(new ProductInfo<>(id, quantity));
				product.setQuantity(--quantity);
				if (product.getQuantity() == 0) {
					throw new ProductNotFoundException();
				}
			}
		} catch (Exception e) {
			throw new ProductNotFoundException();
		}
	}

	public void showOrder() {
		for (ProductInfo<Integer, Integer> productInfo : info) {
			System.out.println(productInfo.id + " " + productInfo.quantity);
		}
	}

	public List<ProductInfo<Integer, Integer>> getInfo() {
		return info;
	}

	@Override
	public String toString() {
		return "Order " + info;
	}
}
